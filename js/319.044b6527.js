"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[319],{4319:function(t,e,o){o.r(e),o.d(e,{default:function(){return w}});var r=o(6768),i=o(5130);const a={class:"form-container"},l={class:"form-group row"},s={class:"form-group row"},n={class:"form-group row"},p={key:0,class:"form-group row"},d={class:"form-group row"},c={class:"photo-upload"},u={class:"photo-previews"},h=["src"],m={class:"form-actions"};function f(t,e,o,f,g,k){return(0,r.uX)(),(0,r.CE)("div",a,[e[13]||(e[13]=(0,r.Lk)("h2",{class:"form-title"},"게시글 작성",-1)),(0,r.Lk)("div",l,[e[8]||(e[8]=(0,r.Lk)("label",{for:"title"},"제목",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"title","onUpdate:modelValue":e[0]||(e[0]=t=>g.form.Title=t),placeholder:"제목을 입력하세요."},null,512),[[i.Jo,g.form.Title]])]),(0,r.Lk)("div",s,[e[9]||(e[9]=(0,r.Lk)("label",{for:"author"},"작성자",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"author","onUpdate:modelValue":e[1]||(e[1]=t=>g.form.Uid=t),disabled:""},null,512),[[i.Jo,g.form.Uid]])]),(0,r.Lk)("div",n,[e[10]||(e[10]=(0,r.Lk)("label",{for:"content"},"내용",-1)),(0,r.bo)((0,r.Lk)("textarea",{id:"content","onUpdate:modelValue":e[2]||(e[2]=t=>g.form.Content=t),placeholder:"내용을 입력하세요."},null,512),[[i.Jo,g.form.Content]])]),g.isAdmin?((0,r.uX)(),(0,r.CE)("div",p,[e[11]||(e[11]=(0,r.Lk)("label",{for:"notice"},"공지 설정",-1)),(0,r.bo)((0,r.Lk)("input",{type:"checkbox",id:"notice","onUpdate:modelValue":e[3]||(e[3]=t=>g.form.Notice=t)},null,512),[[i.lH,g.form.Notice]])])):(0,r.Q3)("",!0),(0,r.Lk)("div",d,[e[12]||(e[12]=(0,r.Lk)("label",{for:"photos"},"이미지",-1)),(0,r.Lk)("div",c,[(0,r.Lk)("input",{type:"file",id:"photos",accept:"image/*",onChange:e[4]||(e[4]=(...t)=>k.handleFileUpload&&k.handleFileUpload(...t)),ref:"fileInput",style:{display:"none"}},null,544),(0,r.Lk)("button",{onClick:e[5]||(e[5]=(...t)=>k.triggerFileInput&&k.triggerFileInput(...t))},"이미지 선택"),(0,r.Lk)("div",u,[g.previews.length?((0,r.uX)(),(0,r.CE)("img",{key:0,src:g.previews[0],alt:"미리보기 이미지",class:"preview-image"},null,8,h)):(0,r.Q3)("",!0),g.previews.length?((0,r.uX)(),(0,r.CE)("button",{key:1,onClick:e[6]||(e[6]=(...t)=>k.handleFileDelete&&k.handleFileDelete(...t))},"삭제")):(0,r.Q3)("",!0)])])]),(0,r.Lk)("div",m,[(0,r.Lk)("button",{class:"submit",onClick:e[7]||(e[7]=(...t)=>k.submitPost&&k.submitPost(...t))},"작성하기")])])}o(4114),o(4603),o(7566),o(8721);var g=o(4373),k=o(5068),b={data(){return{form:{Title:"",Uid:"",Content:"",Notice:!1},photos:[],previews:[],isAdmin:!1}},created(){const t=localStorage.getItem("token");if(t)try{const e=(0,k.s)(t);this.form.Uid=e.userID,this.isAdmin=1===e.auth}catch(e){console.error("JWT 디코딩 오류:",e),alert("로그인 정보가 유효하지 않습니다."),this.$router.push("/login")}else alert("로그인이 필요합니다."),this.$router.push("/login")},methods:{triggerFileInput(){this.$refs.fileInput.click()},handleFileUpload(t){const e=t.target.files[0];e&&e.type.startsWith("image/")?(this.photos=[e],this.previews=[URL.createObjectURL(e)]):alert("이미지만 업로드할 수 있습니다.")},handleFileDelete(){this.photos=[],this.previews=[]},async submitPost(){if(!this.form.Title.trim()||!this.form.Content.trim())return void alert("제목과 내용을 모두 입력해주세요.");const t=new Date;this.form.Reg_Date=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`;try{const t=new FormData;t.append("Title",this.form.Title),t.append("Uid",this.form.Uid),t.append("Content",this.form.Content),t.append("Notice",this.form.Notice?"1":"0"),t.append("Reg_date",this.form.Reg_Date),this.photos.length>0&&t.append("Image",this.photos[0]),console.log("Reg_DATE",this.form.Reg_Date);const e=await g.A.post("http://localhost:3000/writepost",t,{headers:{"Content-Type":"multipart/form-data"}});console.log("서버 응답:",e.data),alert("게시글이 성공적으로 작성되었습니다."),this.$router.push("/board/page_1")}catch(e){console.error("게시글 작성 오류:",e.response?.data),alert(e.response?.data?.error||"게시글 작성 중 오류가 발생했습니다.")}}}},v=o(1241);const L=(0,v.A)(b,[["render",f],["__scopeId","data-v-09ebd813"]]);var w=L}}]);
//# sourceMappingURL=319.044b6527.js.map