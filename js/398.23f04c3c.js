"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[398],{3398:function(t,e,s){s.r(e),s.d(e,{default:function(){return b}});var o=s(6768),a=s(4232);const i={class:"view-post-container"},n={class:"post-info"},r={class:"post-title-meta"},l={class:"post-title"},c={class:"post-meta"},d={class:"post-content"},u={class:"post-image-container"},p={key:0},g=["src"],h={class:"button-container"};function m(t,e,s,m,k,v){return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("div",n,[(0,o.Lk)("div",r,[(0,o.Lk)("div",l,(0,a.v_)(k.post.Title),1),(0,o.Lk)("div",c,[(0,o.eW)((0,a.v_)(k.post.Uid)+" ",1),e[3]||(e[3]=(0,o.Lk)("br",null,null,-1)),(0,o.eW)(" "+(0,a.v_)(v.formatDate(k.post.Reg_date)),1)])]),(0,o.Lk)("div",d,(0,a.v_)(k.post.Content),1),(0,o.Lk)("div",u,[k.post.Image&&"string"===typeof k.post.Image?((0,o.uX)(),(0,o.CE)("div",p,[(0,o.Lk)("img",{src:`data:image/jpeg;base64,${k.post.Image}`,alt:"첨부 이미지",class:"post-image"},null,8,g)])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",h,[(0,o.Lk)("button",{class:"back-button",onClick:e[0]||(e[0]=(...t)=>v.goBack&&v.goBack(...t))},"목록으로"),v.canDeletePost||v.isAdmin?((0,o.uX)(),(0,o.CE)("button",{key:0,class:"delete-button",onClick:e[1]||(e[1]=(...t)=>v.confirmDeletePost&&v.confirmDeletePost(...t))}," 삭제하기 ")):(0,o.Q3)("",!0),v.canEditPost?((0,o.uX)(),(0,o.CE)("button",{key:1,class:"edit-button",onClick:e[2]||(e[2]=(...t)=>v.goToUpdatePost&&v.goToUpdatePost(...t))}," 수정하기 ")):(0,o.Q3)("",!0)])])}s(4114);var k=s(4373),v=s(5068),f={name:"ViewPost",data(){return{post:{Title:"",Uid:"",Reg_date:"",Content:"",Image:null},id:null,auth:null,previousPage:1}},computed:{canDeletePost(){return this.id===this.post.Uid},canEditPost(){return this.id===this.post.Uid},isAdmin(){return 1===this.auth}},async created(){const t=this.$route.query;if(!t.uid||!t.regDate)return alert("잘못된 요청입니다."),void this.goBack();const e=localStorage.getItem("token");if(!e)return alert("로그인이 필요합니다."),void this.$router.push("/login");try{const t=(0,v.s)(e);this.id=t.userID,this.auth=t.auth}catch(s){return console.error("JWT 디코딩 오류:",s),void this.$router.push("/login")}try{const e=await k.A.get("http://localhost:3000/viewpost",{params:{uid:t.uid,regDate:t.regDate}});this.post=e.data}catch(s){console.error("게시글 데이터를 가져오는 중 오류 발생:",s),alert("게시글 정보를 불러오는 데 실패했습니다."),this.goBack()}},methods:{goBack(){this.$router.push({name:"board",params:{page:this.previousPage}})},goToUpdatePost(){console.log("수정하기 버튼 클릭"),this.$router.push({name:"UpdatePost",query:{uid:this.post.Uid,regDate:this.post.Reg_date,title:this.post.Title,content:this.post.Content,images:this.post.Image?[`data:image/jpeg;base64,${this.post.Image}`]:[]}})},confirmDeletePost(){confirm("정말로 삭제하시겠습니까?")&&this.deletePost()},async deletePost(){try{console.log("UID delete:",this.post.Uid),console.log("UID Reg Date:",this.post.Reg_date),await k.A.delete("http://localhost:3000/deletepost",{data:{uid:this.post.Uid,regDate:this.post.Reg_date}}),alert("게시글이 삭제되었습니다."),this.goBack()}catch(t){console.error("게시글 삭제 중 오류 발생:",t),alert("게시글 삭제에 실패했습니다.")}},formatDate(t){const e=new Date(t);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}}},D=s(1241);const P=(0,D.A)(f,[["render",m],["__scopeId","data-v-41286046"]]);var b=P}}]);
//# sourceMappingURL=398.23f04c3c.js.map