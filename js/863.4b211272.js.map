{"version":3,"file":"js/863.4b211272.js","mappings":"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","sources":["webpack://frontend/./src/pages/board/UpdatePost.vue","webpack://frontend/./src/pages/board/UpdatePost.vue?9277"],"sourcesContent":["<template>\r\n  <div class=\"form-container\">\r\n    <h2 class=\"form-title\">게시글 수정</h2>\r\n    <!-- 제목 입력 -->\r\n    <div class=\"form-group row\">\r\n      <label for=\"title\">제목</label>\r\n      <input type=\"text\" id=\"title\" v-model=\"form.Title\" placeholder=\"제목을 입력하세요.\" />\r\n    </div>\r\n    <!-- 작성자 -->\r\n    <div class=\"form-group row\">\r\n      <label for=\"author\">작성자</label>\r\n      <input type=\"text\" id=\"author\" v-model=\"form.Uid\" disabled />\r\n    </div>\r\n    <!-- 내용 입력 -->\r\n    <div class=\"form-group row\">\r\n      <label for=\"content\">내용</label>\r\n      <textarea id=\"content\" v-model=\"form.Content\" placeholder=\"내용을 입력하세요.\"></textarea>\r\n    </div>\r\n    <!-- 이미지 업로드 -->\r\n    <div class=\"form-group row\">\r\n      <label for=\"photos\">이미지 업로드</label>\r\n      <div class=\"photo-upload\">\r\n        <input\r\n          type=\"file\"\r\n          id=\"photos\"\r\n          accept=\"image/*\"\r\n          @change=\"handleFileUpload\"\r\n          ref=\"fileInput\"\r\n          style=\"display: none;\"\r\n        />\r\n        <button @click=\"triggerFileInput\">이미지 선택</button>\r\n        <div class=\"photo-previews\">\r\n          <img\r\n            v-if=\"previews.length\"\r\n            :src=\"previews[0]\"\r\n            alt=\"미리보기 이미지\"\r\n            class=\"preview-image\"\r\n          />\r\n          <button v-if=\"previews.length\" @click=\"handleFileDelete\">삭제</button>\r\n          <div v-else-if=\"originalImage\">\r\n            <img\r\n              :src=\"originalImage\"\r\n              alt=\"기존 이미지\"\r\n              class=\"preview-image\"\r\n            />\r\n            <button @click=\"handleFileDelete\">삭제</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- 수정 버튼 -->\r\n    <div class=\"form-actions\">\r\n      <button class=\"update\" @click=\"updatePost\">수정하기</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      form: {\r\n        id: \"\", // 게시글 ID\r\n        Title: \"\",\r\n        Uid: \"\",\r\n        Content: \"\",\r\n        Notice: \"0\",\r\n        Image: null, // 이미지 상태\r\n      },\r\n      photos: [], // 새로 업로드된 이미지\r\n      previews: [], // 새로 업로드된 이미지의 미리보기 URL\r\n      originalImage: null, // 기존 이미지 식별자\r\n    };\r\n  },\r\n  created() {\r\n    const query = this.$route.query;\r\n\r\n    // 전달받은 데이터를 초기화\r\n    this.form.Title = query.title || \"\";\r\n    this.form.Uid = query.uid || \"\";\r\n    this.form.Content = query.content || \"\";\r\n    this.originalImage = query.images.length ? query.images[0] : null;\r\n\r\n    const token = localStorage.getItem(\"token\");\r\n    if (token) {\r\n      try {\r\n        const user = jwtDecode(token);\r\n        if (user.userID !== this.form.Uid) {\r\n          alert(\"작성자만 게시글을 수정할 수 있습니다.\");\r\n          this.$router.push(\"/board/page_1\");\r\n        }\r\n      } catch (error) {\r\n        console.error(\"JWT 디코딩 오류:\", error);\r\n        alert(\"로그인 정보가 유효하지 않습니다.\");\r\n        this.$router.push(\"/login\");\r\n      }\r\n    } else {\r\n      alert(\"로그인이 필요합니다.\");\r\n      this.$router.push(\"/login\");\r\n    }\r\n  },\r\n  methods: {\r\n    triggerFileInput() {\r\n      this.$refs.fileInput.click();\r\n    },\r\n    handleFileUpload(event) {\r\n      const file = event.target.files[0];\r\n      if (file && file.type.startsWith(\"image/\")) {\r\n        this.photos = [file];\r\n        this.previews = [URL.createObjectURL(file)];\r\n        this.originalImage = null; // 새 이미지를 업로드하면 기존 이미지를 제거\r\n        this.form.Image = null; // 새 이미지를 업로드하므로 삭제 상태 초기화\r\n      } else {\r\n        alert(\"이미지만 업로드할 수 있습니다.\");\r\n      }\r\n    },\r\n    handleFileDelete() {\r\n    this.photos = [];\r\n    this.previews = [];\r\n    this.originalImage = null;\r\n    this.form.Image = \"delete\"; // 명시적으로 삭제 표시\r\n},\r\n    async updatePost() {\r\n      if (!this.form.Title.trim() || !this.form.Content.trim()) {\r\n        alert(\"제목과 내용을 모두 입력해주세요.\");\r\n        return;\r\n      }\r\n\r\n      const now = new Date();\r\n      this.form.Reg_Date = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, \"0\")}-${String(\r\n        now.getDate()\r\n      ).padStart(2, \"0\")} ${String(now.getHours()).padStart(2, \"0\")}:${String(now.getMinutes()).padStart(2, \"0\")}:${String(\r\n        now.getSeconds()\r\n      ).padStart(2, \"0\")}`;\r\n\r\n      try {\r\n        const formData = new FormData();\r\n        formData.append(\"Uid\", this.form.Uid); // 작성자\r\n        formData.append(\"Reg_date\", this.$route.query.regDate); // 기존 작성 시간\r\n        formData.append(\"Title\", this.form.Title); // 수정된 제목\r\n        formData.append(\"Content\", this.form.Content); // 수정된 내용\r\n        formData.append(\"New_Reg_date\", this.form.Reg_Date); // 새로운 작성 시간\r\n\r\n        // 이미지 처리\r\n        if (this.photos.length > 0) {\r\n          // 새로 업로드된 이미지가 있으면 추가\r\n          formData.append(\"Image\", this.photos[0]);\r\n        } else if (this.form.Image === \"delete\") {\r\n          // 이미지 삭제 요청\r\n          formData.append(\"Image\", \"delete\");\r\n        } else if (this.originalImage) {\r\n          // 기존 이미지를 유지\r\n          formData.append(\"Image\", \"original\");\r\n        } else {\r\n          // 이미지가 없으면 null로 처리\r\n          formData.append(\"Image\", null);\r\n        }\r\n\r\n        await axios.put(\"http://localhost:3000/updatepost\", formData, {\r\n          headers: { \"Content-Type\": \"multipart/form-data\" },\r\n        });\r\n\r\n        alert(\"게시글이 성공적으로 수정되었습니다.\");\r\n\r\n        // 수정된 게시글로 이동\r\n        this.$router.push({\r\n          name: \"ViewPost\",\r\n          query: {\r\n            uid: this.form.Uid,\r\n            regDate: this.form.Reg_Date, // 새로운 작성 시간으로 이동\r\n          },\r\n        });\r\n      } catch (error) {\r\n        console.error(\"게시글 수정 오류:\", error.response?.data);\r\n        alert(error.response?.data?.error || \"게시글 수정 중 오류가 발생했습니다.\");\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n\r\n\r\n\r\n<style scoped>\r\n/* 스타일은 WritePost와 동일하게 유지 */\r\n.form-container {\r\n  width: 950px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n  border-style: solid;\r\n  border-color: black;\r\n  border-radius: 10px;\r\n  font-family: Arial, sans-serif;\r\n}\r\n\r\n.form-title {\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.form-group.row {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  border-top: 1px solid #ccc;\r\n  padding: 10px 0;\r\n}\r\n\r\nlabel {\r\n  font-weight: bold;\r\n  flex: 0 0 80px;\r\n}\r\n\r\ninput[type='text'],\r\ntextarea {\r\n  flex: 1;\r\n  padding: 8px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n  font-family: Arial, sans-serif;\r\n  margin-left: 20px;\r\n}\r\n\r\ntextarea {\r\n  height: 150px;\r\n}\r\n\r\n.photo-upload {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: flex-start;\r\n  gap: 10px;\r\n}\r\n\r\n.photo-previews {\r\n  margin-top: 10px;\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 10px;\r\n}\r\n\r\n.photo-item {\r\n  position: relative;\r\n  display: inline-block;\r\n}\r\n\r\n.preview-image {\r\n  width: 100px;\r\n  height: 100px;\r\n  object-fit: cover;\r\n  border-radius: 4px;\r\n  border: 1px solid #ddd;\r\n}\r\n\r\n.photo-item button {\r\n  position: absolute;\r\n  top: 5px;\r\n  right: 5px;\r\n  padding: 2px 6px;\r\n  border: none;\r\n  background-color: #dc3545;\r\n  color: white;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 10px;\r\n}\r\n\r\n.form-actions {\r\n  text-align: right;\r\n  margin-top: 20px;\r\n}\r\n\r\n.update {\r\n  padding: 10px 20px;\r\n  background-color: #28a745;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\n\r\n.delete {\r\n  padding: 10px 20px;\r\n  background-color: #dc3545;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\n\r\n.update:hover {\r\n  background-color: #218838;\r\n}\r\n\r\n.delete:hover {\r\n  background-color: #c82333;\r\n}\r\n</style>","import { render } from \"./UpdatePost.vue?vue&type=template&id=8fe48f66&scoped=true\"\nimport script from \"./UpdatePost.vue?vue&type=script&lang=js\"\nexport * from \"./UpdatePost.vue?vue&type=script&lang=js\"\n\nimport \"./UpdatePost.vue?vue&type=style&index=0&id=8fe48f66&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-8fe48f66\"]])\n\nexport default __exports__"],"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","for","type","id","_cache","$event","$data","form","Title","placeholder","_hoisted_3","Uid","disabled","_hoisted_4","Content","_hoisted_5","_hoisted_6","accept","onChange","args","$options","handleFileUpload","ref","style","onClick","triggerFileInput","_hoisted_7","previews","length","src","alt","_hoisted_8","_createCommentVNode","handleFileDelete","originalImage","_hoisted_9","_hoisted_10","_hoisted_11","updatePost","data","Notice","Image","photos","created","query","this","$route","title","uid","content","images","token","localStorage","getItem","user","jwtDecode","userID","alert","$router","push","error","console","methods","$refs","fileInput","click","event","file","target","files","startsWith","URL","createObjectURL","trim","now","Date","Reg_Date","getFullYear","String","getMonth","padStart","getDate","getHours","getMinutes","getSeconds","formData","FormData","append","regDate","axios","put","headers","name","response","__exports__","render"],"sourceRoot":""}